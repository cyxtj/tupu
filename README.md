##1 实现功能
用户在搜索真实/小说/影视作品中的人物时，向用户推荐与其搜索的人物具有一定关联的人物，这里的关联是指与该人物具有一定的社会关系或实际联系的人物。并绘制“人物关系图”，帮助用户更全面的了解其搜索人物的背景及关系网络。
	
##2 算法介绍
###2.1 FolkRe算法——查找相关人物
人物之间的关联这种关系比较复杂，因此需要通过多方面的数据来挖掘这种关联性。我们认为以下两个方面可以体现人物i，j之间的关联：

- **相似性：**在短时间内，搜索人物i的用户中有多少比例的用户也搜索了用户j；比例越大，代表人物i，j之间越有关联

- **相关性：**人物i，j同时出现在同一张页面上的频率；频率越高，代表人物i，j之间越有关联


设C为人物i，j的关联性，则有以下公式：

<code>C = α*C1 + β*C2</code> 

其中C1、C2为不同情况下的关联值，α、β为归一化因子。
C1为搜索人物i的用户中也搜索了用户j的比例；C2为包含i，j的网页中，i、j出现在同一页面的频率。

FolkRe算法主要负责针对某一特定人物，结合以上三个方面寻找与其高关联性的人物，并返回固定的数据格式：

<code>人物i, 人物j, 关联值</code>

###2.2 FolkLabel算法——确定关系标签
### 算法解释
通过FolkRe可以确定与人物i具有最高的关联性的N个人物（简称为TopN人物，下文亦如此），但有时具有比较强的关联不一定代表二者会有具体的社会关系等，相对应的，具有比较紧密社会关系的人也许并不会有太强的关联性，比如搜索“谢霆锋”时，其父“谢贤”并不一定会出现在我们推荐的相关联人物中；另外，也许两个人物的关联性并不是特别强，但却有些隐含的关系，比如两个比较热门但关联性不高的人祖籍、生日、学校等可能一致。我们称这样确定的关系为“隐含关系”，而FolkLabel算法则用来确定这样的“隐含关系”。以标准的人物百科名片为例，我们感兴趣的只有几个属性，如 <code>出生日期</code>，<code>出生地</code>，<code>家乡</code>，<code>毕业院校</code>，<code>配偶</code>，<code>妻子</code>，<code>丈夫</code>，<code>儿子</code>，<code>父亲</code>，<code>母亲</code>，<code>好友</code>
<blockquote>
<p>注：还需要从百度百科获取更多的这种属性数据</p>
</blockquote>
设所有我们感兴趣的这些属性集合设为<code>Atr</code>；而属性集<code>Atr</code>根据是否直接提供有关系的人，还能够分为直接属性集<code>AtrD</code>（如：<code>配偶</code>，<code>儿子</code>，<code>父亲</code>，<code>母亲</code>，<code>好友</code>等）和间接属性集<code>AtrA</code>（如<code>出生日期</code>，<code>出生地</code>等）。
### 算法逻辑
FolkLabel主要完成隐含关系挖掘和人工标定标签这两个功能。其中，隐含关系挖掘函数用于寻找与用户在词条中有联系的用户（简称为TopC人物，下文亦如此）；而人工标定标签函数则用来对TopN人物和TopC人物进行关系的确定。

1. **隐含关系挖掘**

	首先挖掘人物i的百科词条
	- 如果词条中有在<code>Atr</code>集合中的属性（即有直接属性），先判断其是直接还是间接属性。
		- 如果是<code>AtrD</code>属性，则将对应人物以及<code>AtrD</code>属性值以一定格式返回KV_TopC；
		- 如果是<code>AtrA</code>属性，则先在人物百科的数据库中检索与其属性具有相同值的人物，返回热度最高的人物以及<code>AtrA</code>属性值对应的关系或空集返回KV_TopC。
	- 如果词条中没有在<code>Atr</code>集合中的属性，则返回空集给KV_TopC。

2. **人工标定标签**
	
	人工的标签标定方式主要有以下两个方法：

	- **挖掘现有词条：**查询人物i与TopN的百度百科名片，寻找具有相同值的属性，通过比较简单的语义理解判断有关联的人物之间的关系。

	- **人工标定：**将人物i与TopN人物，以及人物关系标签，一并推送给对应的人物/小说/电影的贴吧，由贴吧中海量熟知人物关系的网友以固定的数据格式进行人物之间关系的标定。同时贴吧用户也可以反馈和人物i具有关联的其他人物并同时添加标签，以完善FolkLabel算法的第一步。

结合以上二者，用于确定人物i与TopN人物关系标签的算法即为FolkLabel算法。FolkLabel算法主要负责标签标签数据的搜集、汇总和整理。在确定好人物i、TopN人物以及关系标签后，组织为固定的数据格式：
<code>人物一, 人物二, 关系</code>，即 <code>i, TopN(i,j), Re(i,j)</code>
<blockquote>
<p>注：之所以把寻找隐含关系和关系标签的确定设计为同一个函数，是因为隐含关系和用户的相关性是比较独立的，如果关联性用FolkRe算法确定的话会造成混乱；另一方面，这样设计对于百科中有关系记录的人物，避免了人物关系标签的重复计算，在保持TopN人物和TopC人物独立分开的情况下，能更快的返回“用户-关系”对</p>
</blockquote>

##3 需要数据
* 用户搜索记录的历史数据
* 一些小说/电影/新闻文本
* 人物的词条
* 一些关系标签
		
##4. 项目实现：
难点：冷启动，建立关系数据库，用户查询-响应机制，关系标签组织，贴吧标定标签形式
###4.1 启动流程：
应该分为社会人、虚拟人（影视/小说）两种人物关系网络
### 社会人：
1. 冷启动时的人物，主要是目前的百度热搜榜单“人物”榜单上每个领域Top50热门的人物
2. 针对每个人物用FolkRe寻找关联人物TopN，并利用FolkLabel算法确定人物i及不同组合的关系标签，至此，第一层关系网络可以确定
3. 对出现在网络里的TopN人物，进行迭代，可以确定多层关系网络，如果TopN中出现了未收录在百度百科中的人物时，则将其从下次进行迭代的TopN人物中剔除
4. 最后，社会人物关系网络会形成以少数热门知名人物为巨型节点的无尺度网络。
### 虚拟人：
1. 冷启动时的人物，主要是目前的百度热搜榜单娱乐榜中的电影、电视剧、动漫以及小说榜上每个领域Top50热门影视剧、小说中的主要角色。
2. 针对每个人物用FolkRe寻找关联人物TopN，并利用FolkLabel算法确定人物i及不同组合的关系标签，至此，第一层关系网络可以确定
3. 对出现在网络里的TopN人物，进行迭代，可以确定多层关系网络，如果TopN中出现了未收录在百度百科中的人物时，则将其从下次进行迭代的TopN人物中剔除
4. 最后，虚拟人物关系网络会形成以少数热门知名人物为巨型节点的无尺度网络。

###4.2 关系数据库
建立、维护和更新
###4.3 关系标签
生成和贴吧人工标定
###4.4 关系网络的绘制
绘制对应的人物关系网络图，人物关系网络图和原有的“知心推荐”的列表的人物并不一定是一致的，关系网络图更着重体现与用户所检索的人物有实际联系、关系的人物。因此要分开显示于原右侧推荐栏上方，以缩略图形式展现数据。用户点击缩略图后可以进入单独的关系网络页面，显示更为立体全面的关系网络。

绘制关系网络，需要知道关系网络中TopN人物与人物i的关联性，以及二者之间的关系。其中，TopN人物与人物i关联性越高，其所在的节点也就越大；而两个节点对应的边是无权的，边上显示二者的关系。因此，最后绘制关系网络时需要两组数据：

* 每个TopN人物节点的大小：<code>人物i, 关联值</code>

* 每个TopN人物节点的大小：<code>人物一, 人物二, 关系</code>

以百度Echarts绘制乔布斯的人物关系网络为例,数据的组织格式为（部分）：
><pre>
>nodes:[
>        {category:0, name: '乔布斯', value : 10},
>        {category:1, name: '丽萨-乔布斯',value : 2},
>        {category:1, name: '保罗-乔布斯',value : 3},
>        {category:1, name: '克拉拉-乔布斯',value : 3}
>    ],
>    links : [
>        {source : '丽萨-乔布斯', target : '乔布斯', weight : 1, name: '女儿'},
>        {source : '保罗-乔布斯', target : '乔布斯', weight : 2, name: '父亲'},
>        {source : '克拉拉-乔布斯', target : '乔布斯', weight : 1, name: '母亲'},
>        {source : '劳伦-鲍威尔', target : '乔布斯', weight : 2},
>        {source : '史蒂夫-沃兹尼艾克', target : '乔布斯', weight : 3, name: '合伙人'}
>    ]
>}
></pre>

###4.5 用户界面
查询-响应机制
